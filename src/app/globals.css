@import "tailwindcss";
@plugin "@tailwindcss/typography";

/* Gruvbox Light Theme (default) */
:root,
.light {
  --background: 48 87% 88%; /* #fbf1c7 */
  --foreground: 30 12% 23%; /* #3c3836 */

  --card: 47 58% 82%; /* #f2e5bc */
  --card-foreground: 30 12% 23%; /* #3c3836 */

  --popover: 47 58% 82%; /* #f2e5bc */
  --popover-foreground: 30 12% 23%; /* #3c3836 */

  --primary: 194 74% 24%; /* #076678 - Gruvbox blue */
  --primary-foreground: 50 100% 91%; /* #F9F5D7 - Gruvbox light0 hard */

  --secondary: 42 38% 81%; /* #ebdbb2 */
  --secondary-foreground: 30 12% 23%; /* #3c3836 */

  --muted: 40 26% 73%; /* #d5c4a1 */
  --muted-foreground: 30 9% 34%; /* #665c54 */

  --accent: 324 41% 34%; /* #8f3f71 - Gruvbox purple */
  --accent-foreground: 50 100% 91%; /* #F9F5D7 - Gruvbox light0 hard */

  --destructive: 6 78% 45%; /* #cc241d - Gruvbox red */
  --destructive-foreground: 50 100% 91%; /* #F9F5D7 - Gruvbox light0 hard */

  --border: 37 22% 65%; /* #bdae93 */
  --input: 37 22% 65%; /* #bdae93 */
  --ring: 194 74% 24%; /* #076678 */

  --radius: 0.5rem;

  /* Canvas-specific */
  --canvas-bg: 48 87% 88%; /* #fbf1c7 */
  --canvas-grid: 40 26% 73%; /* #d5c4a1 */
  --canvas-dot: 30 9% 50%; /* gray */

  /* Node colors */
  --node-text-bg: 47 58% 82%; /* #f2e5bc */
  --node-text-border: 37 22% 65%; /* #bdae93 */

  --node-note-bg: 43 74% 75%; /* warm yellow - #e9d8a6 */
  --node-note-border: 40 73% 42%; /* #b68900 darker yellow */
  --node-note-accent: 40 73% 42%; /* #b68900 */

  --node-chat-from: 194 50% 80%; /* light aqua */
  --node-chat-to: 324 30% 80%; /* light purple */
  --node-chat-border: 194 74% 30%; /* #076678 darker */
  --node-chat-accent: 194 74% 30%; /* aqua darker */
  --node-chat-foreground: 30 12% 23%; /* dark text for light bg */

  --edge-stroke: 324 41% 34%; /* #8f3f71 */
  --edge-label: 324 41% 34%;
  --edge-label-bg: 47 58% 85%;

  /* Button colors */
  --btn-primary: 194 74% 24%; /* #076678 */
  --btn-primary-hover: 194 74% 20%;
  --btn-danger: 6 78% 45%; /* #cc241d */
  --btn-danger-hover: 6 78% 38%;
  --btn-link: 324 41% 34%; /* #8f3f71 */

  /* Status colors */
  --success: 61 66% 35%; /* #98971a - Gruvbox green */
  --warning: 40 73% 49%; /* #d79921 - Gruvbox yellow */
  --error: 6 78% 45%; /* #cc241d */
}

/* Zinc Dark Theme */
.dark {
  --background: 240 6% 4%; /* #09090b */
  --foreground: 0 0% 98%; /* #fafafa */

  --card: 240 4% 10%; /* #18181b */
  --card-foreground: 0 0% 98%; /* #fafafa */

  --popover: 240 4% 10%; /* #18181b */
  --popover-foreground: 0 0% 98%; /* #fafafa */

  --primary: 217 91% 60%; /* #3b82f6 - blue */
  --primary-foreground: 0 0% 100%; /* white */

  --secondary: 240 4% 16%; /* #27272a */
  --secondary-foreground: 0 0% 98%; /* #fafafa */

  --muted: 240 4% 16%; /* #27272a */
  --muted-foreground: 240 4% 65%; /* #a1a1aa */

  --accent: 239 84% 67%; /* #6366f1 - indigo */
  --accent-foreground: 0 0% 100%; /* white */

  --destructive: 0 72% 51%; /* #dc2626 - red */
  --destructive-foreground: 0 0% 100%; /* white */

  --border: 240 4% 27%; /* #3f3f46 */
  --input: 240 4% 27%; /* #3f3f46 */
  --ring: 239 84% 67%; /* #6366f1 */

  /* Canvas-specific */
  --canvas-bg: 240 6% 4%; /* #09090b */
  --canvas-grid: 240 4% 16%; /* #27272a */
  --canvas-dot: 240 4% 27%; /* #3f3f46 */

  /* Node colors */
  --node-text-bg: 240 4% 16%; /* #27272a */
  --node-text-border: 240 4% 35%; /* lighter border */

  --node-note-bg: 45 80% 20%; /* darker amber/yellow */
  --node-note-border: 45 93% 47%; /* yellow-500 */
  --node-note-accent: 45 93% 47%; /* yellow-500 */

  --node-chat-from: 221 70% 25%; /* blue darker */
  --node-chat-to: 276 50% 30%; /* purple darker */
  --node-chat-border: 221 83% 53%; /* blue-500 */
  --node-chat-accent: 217 91% 60%; /* blue-400 */
  --node-chat-foreground: 0 0% 98%; /* light text for dark bg */

  --edge-stroke: 239 84% 67%; /* #6366f1 */
  --edge-label: 224 93% 81%; /* #a5b4fc */
  --edge-label-bg: 244 47% 20%; /* #1e1b4b */

  /* Button colors */
  --btn-primary: 217 91% 60%; /* blue-600 */
  --btn-primary-hover: 217 91% 55%; /* blue-700 */
  --btn-danger: 0 72% 51%; /* red-600 */
  --btn-danger-hover: 0 72% 45%; /* red-700 */
  --btn-link: 239 84% 67%; /* indigo-500 */

  /* Status colors */
  --success: 142 71% 45%; /* green-500 */
  --warning: 45 93% 47%; /* yellow-500 */
  --error: 0 72% 51%; /* red-600 */
}

@theme inline {
  --color-background: hsl(var(--background));
  --color-foreground: hsl(var(--foreground));
  --color-card: hsl(var(--card));
  --color-card-foreground: hsl(var(--card-foreground));
  --color-popover: hsl(var(--popover));
  --color-popover-foreground: hsl(var(--popover-foreground));
  --color-primary: hsl(var(--primary));
  --color-primary-foreground: hsl(var(--primary-foreground));
  --color-secondary: hsl(var(--secondary));
  --color-secondary-foreground: hsl(var(--secondary-foreground));
  --color-muted: hsl(var(--muted));
  --color-muted-foreground: hsl(var(--muted-foreground));
  --color-accent: hsl(var(--accent));
  --color-accent-foreground: hsl(var(--accent-foreground));
  --color-destructive: hsl(var(--destructive));
  --color-destructive-foreground: hsl(var(--destructive-foreground));
  --color-border: hsl(var(--border));
  --color-input: hsl(var(--input));
  --color-ring: hsl(var(--ring));
  --radius: var(--radius);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

body {
  background: hsl(var(--background));
  color: hsl(var(--foreground));
  font-family: var(--font-sans), Arial, Helvetica, sans-serif;
}

/* React Flow customizations */
.react-flow__node {
  font-family: var(--font-sans);
}

.react-flow__edge-path {
  stroke-width: 2;
}

.react-flow__controls {
  background: hsl(var(--card));
  border: 1px solid hsl(var(--border));
  border-radius: 8px;
}

.react-flow__controls-button {
  background: hsl(var(--card));
  border-bottom: 1px solid hsl(var(--border));
  fill: hsl(var(--muted-foreground));
}

.react-flow__controls-button:hover {
  background: hsl(var(--muted));
}

.react-flow__minimap {
  background: hsl(var(--card)) !important;
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: hsl(var(--card));
}

::-webkit-scrollbar-thumb {
  background: hsl(var(--border));
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: hsl(var(--muted-foreground));
}

/* Animation utilities */
@keyframes bounce {
  0%,
  100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-4px);
  }
}

.animate-bounce {
  animation: bounce 0.6s infinite;
}

.delay-100 {
  animation-delay: 0.1s;
}

.delay-200 {
  animation-delay: 0.2s;
}

/* Line clamp utility */
.line-clamp-6 {
  display: -webkit-box;
  -webkit-line-clamp: 6;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* PWA & Mobile Optimizations */

/* Safe area insets for notched devices */
.safe-area-top {
  padding-top: env(safe-area-inset-top);
}

.safe-area-bottom {
  padding-bottom: env(safe-area-inset-bottom);
}

.safe-area-left {
  padding-left: env(safe-area-inset-left);
}

.safe-area-right {
  padding-right: env(safe-area-inset-right);
}

/* Prevent pull-to-refresh on mobile */
html {
  overscroll-behavior-y: contain;
}

/* Better touch handling */
.touch-manipulation {
  touch-action: manipulation;
}

/* Disable text selection on interactive elements */
button,
[role="button"] {
  -webkit-user-select: none;
  user-select: none;
}

/* Prevent zoom on input focus (iOS) */
@media screen and (max-width: 768px) {
  input,
  textarea,
  select {
    font-size: 16px !important;
  }
}

/* Disable tap highlight on mobile */
* {
  -webkit-tap-highlight-color: transparent;
}

/* Smooth scrolling with momentum */
.overflow-y-auto {
  -webkit-overflow-scrolling: touch;
}

/* Overscroll containment for nested scrollable areas */
.overscroll-contain {
  overscroll-behavior: contain;
}

/* Mobile-friendly focus states */
@media (hover: none) {
  button:hover,
  a:hover {
    /* Disable hover styles on touch devices */
  }

  button:active,
  a:active {
    opacity: 0.7;
  }
}

/* PWA standalone mode adjustments */
@media all and (display-mode: standalone) {
  /* Add extra padding for status bar */
  .safe-area-top {
    padding-top: max(env(safe-area-inset-top), 20px);
  }
}

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Hide scrollbars on mobile for cleaner look */
@media screen and (max-width: 768px) {
  ::-webkit-scrollbar {
    display: none;
  }

  * {
    scrollbar-width: none;
  }
}

/* ==========================================
   Note Editor Styles (Notion-like)
   ========================================== */

/* Base editor styles */
.note-editor-content {
  color: hsl(var(--foreground));
  font-size: 16px;
  line-height: 1.7;
  caret-color: hsl(var(--primary));
}

.note-editor-content:focus {
  outline: none;
}

/* Placeholder for empty nodes */
.note-editor-content .is-empty::before {
  color: hsl(var(--muted-foreground));
  content: attr(data-placeholder);
  float: left;
  height: 0;
  pointer-events: none;
  width: 100%;
}

/* Title placeholder - lighter color for "Untitled" */
.note-editor-content h1.is-empty:first-child::before {
  color: hsl(var(--muted-foreground) / 0.4);
}

/* Headings */
.note-editor-content h1 {
  font-size: 2.25em;
  font-weight: 700;
  line-height: 1.2;
  margin-top: 2em;
  margin-bottom: 0.5em;
  color: hsl(var(--foreground));
  letter-spacing: -0.02em;
}

/* First H1 is the title - Notion-like styling */
.note-editor-content h1:first-child {
  margin-top: 0;
  font-size: 2.5em;
  font-weight: 700;
  letter-spacing: -0.03em;
  margin-bottom: 0.75em;
  padding-bottom: 0.25em;
}

.note-editor-content h2 {
  font-size: 1.5em;
  font-weight: 600;
  line-height: 1.3;
  margin-top: 1.75em;
  margin-bottom: 0.5em;
  color: hsl(var(--foreground));
}

.note-editor-content h3 {
  font-size: 1.25em;
  font-weight: 600;
  line-height: 1.4;
  margin-top: 1.5em;
  margin-bottom: 0.5em;
  color: hsl(var(--foreground));
}

/* Paragraphs */
.note-editor-content p {
  margin-top: 0;
  margin-bottom: 0.75em;
}

.note-editor-content p:last-child {
  margin-bottom: 0;
}

/* Lists */
.note-editor-content ul,
.note-editor-content ol {
  padding-left: 1.5em;
  margin-top: 0.5em;
  margin-bottom: 0.75em;
}

.note-editor-content ul {
  list-style-type: disc;
}

.note-editor-content ol {
  list-style-type: decimal;
}

.note-editor-content li {
  margin-top: 0.25em;
  margin-bottom: 0.25em;
}

.note-editor-content li p {
  margin: 0;
}

/* Nested lists */
.note-editor-content ul ul,
.note-editor-content ol ol,
.note-editor-content ul ol,
.note-editor-content ol ul {
  margin-top: 0.25em;
  margin-bottom: 0.25em;
}

/* Blockquote */
.note-editor-content blockquote {
  border-left: 3px solid hsl(var(--primary) / 0.5);
  padding-left: 1em;
  margin: 1em 0;
  color: hsl(var(--muted-foreground));
}

.note-editor-content blockquote p {
  margin: 0;
}

/* Code */
.note-editor-content code {
  background: hsl(var(--muted));
  color: hsl(var(--foreground));
  padding: 0.15em 0.4em;
  border-radius: 4px;
  font-size: 0.9em;
  font-family: var(--font-mono), ui-monospace, monospace;
}

.note-editor-content pre {
  background: hsl(var(--muted));
  border-radius: 8px;
  padding: 1em;
  margin: 1em 0;
  overflow-x: auto;
}

.note-editor-content pre code {
  background: transparent;
  padding: 0;
  font-size: 0.875em;
  line-height: 1.6;
}

/* Horizontal rule */
.note-editor-content hr {
  border: none;
  border-top: 1px solid hsl(var(--border));
  margin: 2em 0;
}

/* Strong & emphasis */
.note-editor-content strong {
  font-weight: 600;
}

.note-editor-content em {
  font-style: italic;
}

/* Links */
.note-editor-content a {
  color: hsl(var(--primary));
  text-decoration: underline;
  text-underline-offset: 2px;
}

.note-editor-content a:hover {
  text-decoration-color: hsl(var(--primary));
}

/* Wiki link styling */
.wiki-link {
  color: hsl(var(--primary));
  background: hsl(var(--primary) / 0.1);
  padding: 0.1em 0.3em;
  border-radius: 4px;
  text-decoration: none;
  cursor: pointer;
  font-weight: 500;
  transition: background 0.15s ease;
}

.wiki-link:hover {
  background: hsl(var(--primary) / 0.2);
}

/* Selection */
.note-editor-content ::selection {
  background: hsl(var(--primary) / 0.2);
}

/* Slash Command Menu (tippy.js) */
.tippy-box {
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

.tippy-content {
  padding: 0 !important;
}

.tippy-arrow {
  display: none;
}

/* Slash command menu styling */
.slash-command-menu {
  z-index: 50;
  animation: slideIn 0.1s ease-out;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(-4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
